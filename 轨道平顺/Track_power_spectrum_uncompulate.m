% =========================================================================
%
%                  轨道谱
%
% =========================================================================
%
%　(C)2019-2022 铁道科学研究院-基础所
%   版本：V1.0
%   日期：2020年 6月15日
%   作者：s.m.
%--------------------------------------------------------------------------
%  功能： 1.
%        2.
%       3. 
%       4. 
%--------------------------------------------------------------------------

%% 基于逆傅里叶变换的轨道不平顺数值模拟(最终程序)
%反演的轨道谱密度函数为美国六级谱;

%% 此程序变量为Vt，dt，及空间波长范围ld~lu，均需要手动调试；此程序暂定波长范围为0.5~50m；
clear;
close all;
f=[0;0.000976562500000000;0.00195312500000000;0.00292968750000000;0.00390625000000000;0.00488281250000000;0.00585937500000000;0.00683593750000000;0.00781250000000000;0.00878906250000000;0.00976562500000000;0.0107421875000000;0.0117187500000000;0.0126953125000000;0.0136718750000000;0.0146484375000000;0.0156250000000000;0.0166015625000000;0.0175781250000000;0.0185546875000000;0.0195312500000000;0.0205078125000000;0.0214843750000000;0.0224609375000000;0.0234375000000000;0.0244140625000000;0.0253906250000000;0.0263671875000000;0.0273437500000000;0.0283203125000000;0.0292968750000000;0.0302734375000000;0.0312500000000000;0.0322265625000000;0.0332031250000000;0.0341796875000000;0.0351562500000000;0.0361328125000000;0.0371093750000000;0.0380859375000000;0.0390625000000000;0.0400390625000000;0.0410156250000000;0.0419921875000000;0.0429687500000000;0.0439453125000000;0.0449218750000000;0.0458984375000000;0.0468750000000000;0.0478515625000000;0.0488281250000000;0.0498046875000000;0.0507812500000000;0.0517578125000000;0.0527343750000000;0.0537109375000000;0.0546875000000000;0.0556640625000000;0.0566406250000000;0.0576171875000000;0.0585937500000000;0.0595703125000000;0.0605468750000000;0.0615234375000000;0.0625000000000000;0.0634765625000000;0.0644531250000000;0.0654296875000000;0.0664062500000000;0.0673828125000000;0.0683593750000000;0.0693359375000000;0.0703125000000000;0.0712890625000000;0.0722656250000000;0.0732421875000000;0.0742187500000000;0.0751953125000000;0.0761718750000000;0.0771484375000000;0.0781250000000000;0.0791015625000000;0.0800781250000000;0.0810546875000000;0.0820312500000000;0.0830078125000000;0.0839843750000000;0.0849609375000000;0.0859375000000000;0.0869140625000000;0.0878906250000000;0.0888671875000000;0.0898437500000000;0.0908203125000000;0.0917968750000000;0.0927734375000000;0.0937500000000000;0.0947265625000000;0.0957031250000000;0.0966796875000000;0.0976562500000000;0.0986328125000000;0.0996093750000000;0.100585937500000;0.101562500000000;0.102539062500000;0.103515625000000;0.104492187500000;0.105468750000000;0.106445312500000;0.107421875000000;0.108398437500000;0.109375000000000;0.110351562500000;0.111328125000000;0.112304687500000;0.113281250000000;0.114257812500000;0.115234375000000;0.116210937500000;0.117187500000000;0.118164062500000;0.119140625000000;0.120117187500000;0.121093750000000;0.122070312500000;0.123046875000000;0.124023437500000;0.125000000000000;0.125976562500000;0.126953125000000;0.127929687500000;0.128906250000000;0.129882812500000;0.130859375000000;0.131835937500000;0.132812500000000;0.133789062500000;0.134765625000000;0.135742187500000;0.136718750000000;0.137695312500000;0.138671875000000;0.139648437500000;0.140625000000000;0.141601562500000;0.142578125000000;0.143554687500000;0.144531250000000;0.145507812500000;0.146484375000000;0.147460937500000;0.148437500000000;0.149414062500000;0.150390625000000;0.151367187500000;0.152343750000000;0.153320312500000;0.154296875000000;0.155273437500000;0.156250000000000;0.157226562500000;0.158203125000000;0.159179687500000;0.160156250000000;0.161132812500000;0.162109375000000;0.163085937500000;0.164062500000000;0.165039062500000;0.166015625000000;0.166992187500000;0.167968750000000;0.168945312500000;0.169921875000000;0.170898437500000;0.171875000000000;0.172851562500000;0.173828125000000;0.174804687500000;0.175781250000000;0.176757812500000;0.177734375000000;0.178710937500000;0.179687500000000;0.180664062500000;0.181640625000000;0.182617187500000;0.183593750000000;0.184570312500000;0.185546875000000;0.186523437500000;0.187500000000000;0.188476562500000;0.189453125000000;0.190429687500000;0.191406250000000;0.192382812500000;0.193359375000000;0.194335937500000;0.195312500000000;0.196289062500000;0.197265625000000;0.198242187500000;0.199218750000000;0.200195312500000;0.201171875000000;0.202148437500000;0.203125000000000;0.204101562500000;0.205078125000000;0.206054687500000;0.207031250000000;0.208007812500000;0.208984375000000;0.209960937500000;0.210937500000000;0.211914062500000;0.212890625000000;0.213867187500000;0.214843750000000;0.215820312500000;0.216796875000000;0.217773437500000;0.218750000000000;0.219726562500000;0.220703125000000;0.221679687500000;0.222656250000000;0.223632812500000;0.224609375000000;0.225585937500000;0.226562500000000;0.227539062500000;0.228515625000000;0.229492187500000;0.230468750000000;0.231445312500000;0.232421875000000;0.233398437500000;0.234375000000000;0.235351562500000;0.236328125000000;0.237304687500000;0.238281250000000;0.239257812500000;0.240234375000000;0.241210937500000;0.242187500000000;0.243164062500000;0.244140625000000;0.245117187500000;0.246093750000000;0.247070312500000;0.248046875000000;0.249023437500000;0.250000000000000;0.250976562500000;0.251953125000000;0.252929687500000;0.253906250000000;0.254882812500000;0.255859375000000;0.256835937500000;0.257812500000000;0.258789062500000;0.259765625000000;0.260742187500000;0.261718750000000;0.262695312500000;0.263671875000000;0.264648437500000;0.265625000000000;0.266601562500000;0.267578125000000;0.268554687500000;0.269531250000000;0.270507812500000;0.271484375000000;0.272460937500000;0.273437500000000;0.274414062500000;0.275390625000000;0.276367187500000;0.277343750000000;0.278320312500000;0.279296875000000;0.280273437500000;0.281250000000000;0.282226562500000;0.283203125000000;0.284179687500000;0.285156250000000;0.286132812500000;0.287109375000000;0.288085937500000;0.289062500000000;0.290039062500000;0.291015625000000;0.291992187500000;0.292968750000000;0.293945312500000;0.294921875000000;0.295898437500000;0.296875000000000;0.297851562500000;0.298828125000000;0.299804687500000;0.300781250000000;0.301757812500000;0.302734375000000;0.303710937500000;0.304687500000000;0.305664062500000;0.306640625000000;0.307617187500000;0.308593750000000;0.309570312500000;0.310546875000000;0.311523437500000;0.312500000000000;0.313476562500000;0.314453125000000;0.315429687500000;0.316406250000000;0.317382812500000;0.318359375000000;0.319335937500000;0.320312500000000;0.321289062500000;0.322265625000000;0.323242187500000;0.324218750000000;0.325195312500000;0.326171875000000;0.327148437500000;0.328125000000000;0.329101562500000;0.330078125000000;0.331054687500000;0.332031250000000;0.333007812500000;0.333984375000000;0.334960937500000;0.335937500000000;0.336914062500000;0.337890625000000;0.338867187500000;0.339843750000000;0.340820312500000;0.341796875000000;0.342773437500000;0.343750000000000;0.344726562500000;0.345703125000000;0.346679687500000;0.347656250000000;0.348632812500000;0.349609375000000;0.350585937500000;0.351562500000000;0.352539062500000;0.353515625000000;0.354492187500000;0.355468750000000;0.356445312500000;0.357421875000000;0.358398437500000;0.359375000000000;0.360351562500000;0.361328125000000;0.362304687500000;0.363281250000000;0.364257812500000;0.365234375000000;0.366210937500000;0.367187500000000;0.368164062500000;0.369140625000000;0.370117187500000;0.371093750000000;0.372070312500000;0.373046875000000;0.374023437500000;0.375000000000000;0.375976562500000;0.376953125000000;0.377929687500000;0.378906250000000;0.379882812500000;0.380859375000000;0.381835937500000;0.382812500000000;0.383789062500000;0.384765625000000;0.385742187500000;0.386718750000000;0.387695312500000;0.388671875000000;0.389648437500000;0.390625000000000;0.391601562500000;0.392578125000000;0.393554687500000;0.394531250000000;0.395507812500000;0.396484375000000;0.397460937500000;0.398437500000000;0.399414062500000;0.400390625000000;0.401367187500000;0.402343750000000;0.403320312500000;0.404296875000000;0.405273437500000;0.406250000000000;0.407226562500000;0.408203125000000;0.409179687500000;0.410156250000000;0.411132812500000;0.412109375000000;0.413085937500000;0.414062500000000;0.415039062500000;0.416015625000000;0.416992187500000;0.417968750000000;0.418945312500000;0.419921875000000;0.420898437500000;0.421875000000000;0.422851562500000;0.423828125000000;0.424804687500000;0.425781250000000;0.426757812500000;0.427734375000000;0.428710937500000;0.429687500000000;0.430664062500000;0.431640625000000;0.432617187500000;0.433593750000000;0.434570312500000;0.435546875000000;0.436523437500000;0.437500000000000;0.438476562500000;0.439453125000000;0.440429687500000;0.441406250000000;0.442382812500000;0.443359375000000;0.444335937500000;0.445312500000000;0.446289062500000;0.447265625000000;0.448242187500000;0.449218750000000;0.450195312500000;0.451171875000000;0.452148437500000;0.453125000000000;0.454101562500000;0.455078125000000;0.456054687500000;0.457031250000000;0.458007812500000;0.458984375000000;0.459960937500000;0.460937500000000;0.461914062500000;0.462890625000000;0.463867187500000;0.464843750000000;0.465820312500000;0.466796875000000;0.467773437500000;0.468750000000000;0.469726562500000;0.470703125000000;0.471679687500000;0.472656250000000;0.473632812500000;0.474609375000000;0.475585937500000;0.476562500000000;0.477539062500000;0.478515625000000;0.479492187500000;0.480468750000000;0.481445312500000;0.482421875000000;0.483398437500000;0.484375000000000;0.485351562500000;0.486328125000000;0.487304687500000;0.488281250000000;0.489257812500000;0.490234375000000;0.491210937500000;0.492187500000000;0.493164062500000;0.494140625000000;0.495117187500000;0.496093750000000;0.497070312500000;0.498046875000000;0.499023437500000;0.500000000000000;0.500976562500000;0.501953125000000;0.502929687500000;0.503906250000000;0.504882812500000;0.505859375000000;0.506835937500000;0.507812500000000;0.508789062500000;0.509765625000000;0.510742187500000;0.511718750000000;0.512695312500000;0.513671875000000;0.514648437500000;0.515625000000000;0.516601562500000;0.517578125000000;0.518554687500000;0.519531250000000;0.520507812500000;0.521484375000000;0.522460937500000;0.523437500000000;0.524414062500000;0.525390625000000;0.526367187500000;0.527343750000000;0.528320312500000;0.529296875000000;0.530273437500000;0.531250000000000;0.532226562500000;0.533203125000000;0.534179687500000;0.535156250000000;0.536132812500000;0.537109375000000;0.538085937500000;0.539062500000000;0.540039062500000;0.541015625000000;0.541992187500000;0.542968750000000;0.543945312500000;0.544921875000000;0.545898437500000;0.546875000000000;0.547851562500000;0.548828125000000;0.549804687500000;0.550781250000000;0.551757812500000;0.552734375000000;0.553710937500000;0.554687500000000;0.555664062500000;0.556640625000000;0.557617187500000;0.558593750000000;0.559570312500000;0.560546875000000;0.561523437500000;0.562500000000000;0.563476562500000;0.564453125000000;0.565429687500000;0.566406250000000;0.567382812500000;0.568359375000000;0.569335937500000;0.570312500000000;0.571289062500000;0.572265625000000;0.573242187500000;0.574218750000000;0.575195312500000;0.576171875000000;0.577148437500000;0.578125000000000;0.579101562500000;0.580078125000000;0.581054687500000;0.582031250000000;0.583007812500000;0.583984375000000;0.584960937500000;0.585937500000000;0.586914062500000;0.587890625000000;0.588867187500000;0.589843750000000;0.590820312500000;0.591796875000000;0.592773437500000;0.593750000000000;0.594726562500000;0.595703125000000;0.596679687500000;0.597656250000000;0.598632812500000;0.599609375000000;0.600585937500000;0.601562500000000;0.602539062500000;0.603515625000000;0.604492187500000;0.605468750000000;0.606445312500000;0.607421875000000;0.608398437500000;0.609375000000000;0.610351562500000;0.611328125000000;0.612304687500000;0.613281250000000;0.614257812500000;0.615234375000000;0.616210937500000;0.617187500000000;0.618164062500000;0.619140625000000;0.620117187500000;0.621093750000000;0.622070312500000;0.623046875000000;0.624023437500000;0.625000000000000;0.625976562500000;0.626953125000000;0.627929687500000;0.628906250000000;0.629882812500000;0.630859375000000;0.631835937500000;0.632812500000000;0.633789062500000;0.634765625000000;0.635742187500000;0.636718750000000;0.637695312500000;0.638671875000000;0.639648437500000;0.640625000000000;0.641601562500000;0.642578125000000;0.643554687500000;0.644531250000000;0.645507812500000;0.646484375000000;0.647460937500000;0.648437500000000;0.649414062500000;0.650390625000000;0.651367187500000;0.652343750000000;0.653320312500000;0.654296875000000;0.655273437500000;0.656250000000000;0.657226562500000;0.658203125000000;0.659179687500000;0.660156250000000;0.661132812500000;0.662109375000000;0.663085937500000;0.664062500000000;0.665039062500000;0.666015625000000;0.666992187500000;0.667968750000000;0.668945312500000;0.669921875000000;0.670898437500000;0.671875000000000;0.672851562500000;0.673828125000000;0.674804687500000;0.675781250000000;0.676757812500000;0.677734375000000;0.678710937500000;0.679687500000000;0.680664062500000;0.681640625000000;0.682617187500000;0.683593750000000;0.684570312500000;0.685546875000000;0.686523437500000;0.687500000000000;0.688476562500000;0.689453125000000;0.690429687500000;0.691406250000000;0.692382812500000;0.693359375000000;0.694335937500000;0.695312500000000;0.696289062500000;0.697265625000000;0.698242187500000;0.699218750000000;0.700195312500000;0.701171875000000;0.702148437500000;0.703125000000000;0.704101562500000;0.705078125000000;0.706054687500000;0.707031250000000;0.708007812500000;0.708984375000000;0.709960937500000;0.710937500000000;0.711914062500000;0.712890625000000;0.713867187500000;0.714843750000000;0.715820312500000;0.716796875000000;0.717773437500000;0.718750000000000;0.719726562500000;0.720703125000000;0.721679687500000;0.722656250000000;0.723632812500000;0.724609375000000;0.725585937500000;0.726562500000000;0.727539062500000;0.728515625000000;0.729492187500000;0.730468750000000;0.731445312500000;0.732421875000000;0.733398437500000;0.734375000000000;0.735351562500000;0.736328125000000;0.737304687500000;0.738281250000000;0.739257812500000;0.740234375000000;0.741210937500000;0.742187500000000;0.743164062500000;0.744140625000000;0.745117187500000;0.746093750000000;0.747070312500000;0.748046875000000;0.749023437500000;0.750000000000000;0.750976562500000;0.751953125000000;0.752929687500000;0.753906250000000;0.754882812500000;0.755859375000000;0.756835937500000;0.757812500000000;0.758789062500000;0.759765625000000;0.760742187500000;0.761718750000000;0.762695312500000;0.763671875000000;0.764648437500000;0.765625000000000;0.766601562500000;0.767578125000000;0.768554687500000;0.769531250000000;0.770507812500000;0.771484375000000;0.772460937500000;0.773437500000000;0.774414062500000;0.775390625000000;0.776367187500000;0.777343750000000;0.778320312500000;0.779296875000000;0.780273437500000;0.781250000000000;0.782226562500000;0.783203125000000;0.784179687500000;0.785156250000000;0.786132812500000;0.787109375000000;0.788085937500000;0.789062500000000;0.790039062500000;0.791015625000000;0.791992187500000;0.792968750000000;0.793945312500000;0.794921875000000;0.795898437500000;0.796875000000000;0.797851562500000;0.798828125000000;0.799804687500000;0.800781250000000;0.801757812500000;0.802734375000000;0.803710937500000;0.804687500000000;0.805664062500000;0.806640625000000;0.807617187500000;0.808593750000000;0.809570312500000;0.810546875000000;0.811523437500000;0.812500000000000;0.813476562500000;0.814453125000000;0.815429687500000;0.816406250000000;0.817382812500000;0.818359375000000;0.819335937500000;0.820312500000000;0.821289062500000;0.822265625000000;0.823242187500000;0.824218750000000;0.825195312500000;0.826171875000000;0.827148437500000;0.828125000000000;0.829101562500000;0.830078125000000;0.831054687500000;0.832031250000000;0.833007812500000;0.833984375000000;0.834960937500000;0.835937500000000;0.836914062500000;0.837890625000000;0.838867187500000;0.839843750000000;0.840820312500000;0.841796875000000;0.842773437500000;0.843750000000000;0.844726562500000;0.845703125000000;0.846679687500000;0.847656250000000;0.848632812500000;0.849609375000000;0.850585937500000;0.851562500000000;0.852539062500000;0.853515625000000;0.854492187500000;0.855468750000000;0.856445312500000;0.857421875000000;0.858398437500000;0.859375000000000;0.860351562500000;0.861328125000000;0.862304687500000;0.863281250000000;0.864257812500000;0.865234375000000;0.866210937500000;0.867187500000000;0.868164062500000;0.869140625000000;0.870117187500000;0.871093750000000;0.872070312500000;0.873046875000000;0.874023437500000;0.875000000000000;0.875976562500000;0.876953125000000;0.877929687500000;0.878906250000000;0.879882812500000;0.880859375000000;0.881835937500000;0.882812500000000;0.883789062500000;0.884765625000000;0.885742187500000;0.886718750000000;0.887695312500000;0.888671875000000;0.889648437500000;0.890625000000000;0.891601562500000;0.892578125000000;0.893554687500000;0.894531250000000;0.895507812500000;0.896484375000000;0.897460937500000;0.898437500000000;0.899414062500000;0.900390625000000;0.901367187500000;0.902343750000000;0.903320312500000;0.904296875000000;0.905273437500000;0.906250000000000;0.907226562500000;0.908203125000000;0.909179687500000;0.910156250000000;0.911132812500000;0.912109375000000;0.913085937500000;0.914062500000000;0.915039062500000;0.916015625000000;0.916992187500000;0.917968750000000;0.918945312500000;0.919921875000000;0.920898437500000;0.921875000000000;0.922851562500000;0.923828125000000;0.924804687500000;0.925781250000000;0.926757812500000;0.927734375000000;0.928710937500000;0.929687500000000;0.930664062500000;0.931640625000000;0.932617187500000;0.933593750000000;0.934570312500000;0.935546875000000;0.936523437500000;0.937500000000000;0.938476562500000;0.939453125000000;0.940429687500000;0.941406250000000;0.942382812500000;0.943359375000000;0.944335937500000;0.945312500000000;0.946289062500000;0.947265625000000;0.948242187500000;0.949218750000000;0.950195312500000;0.951171875000000;0.952148437500000;0.953125000000000;0.954101562500000;0.955078125000000;0.956054687500000;0.957031250000000;0.958007812500000;0.958984375000000;0.959960937500000;0.960937500000000;0.961914062500000;0.962890625000000;0.963867187500000;0.964843750000000;0.965820312500000;0.966796875000000;0.967773437500000;0.968750000000000;0.969726562500000;0.970703125000000;0.971679687500000;0.972656250000000;0.973632812500000;0.974609375000000;0.975585937500000;0.976562500000000;0.977539062500000;0.978515625000000;0.979492187500000;0.980468750000000;0.981445312500000;0.982421875000000;0.983398437500000;0.984375000000000;0.985351562500000;0.986328125000000;0.987304687500000;0.988281250000000;0.989257812500000;0.990234375000000;0.991210937500000;0.992187500000000;0.993164062500000;0.994140625000000;0.995117187500000;0.996093750000000;0.997070312500000;0.998046875000000;0.999023437500000;1;1.00097656250000;1.00195312500000;1.00292968750000;1.00390625000000;1.00488281250000;1.00585937500000;1.00683593750000;1.00781250000000;1.00878906250000;1.00976562500000;1.01074218750000;1.01171875000000;1.01269531250000;1.01367187500000;1.01464843750000;1.01562500000000;1.01660156250000;1.01757812500000;1.01855468750000;1.01953125000000;1.02050781250000;1.02148437500000;1.02246093750000;1.02343750000000;1.02441406250000;1.02539062500000;1.02636718750000;1.02734375000000;1.02832031250000;1.02929687500000;1.03027343750000;1.03125000000000;1.03222656250000;1.03320312500000;1.03417968750000;1.03515625000000;1.03613281250000;1.03710937500000;1.03808593750000;1.03906250000000;1.04003906250000;1.04101562500000;1.04199218750000;1.04296875000000;1.04394531250000;1.04492187500000;1.04589843750000;1.04687500000000;1.04785156250000;1.04882812500000;1.04980468750000;1.05078125000000;1.05175781250000;1.05273437500000;1.05371093750000;1.05468750000000;1.05566406250000;1.05664062500000;1.05761718750000;1.05859375000000;1.05957031250000;1.06054687500000;1.06152343750000;1.06250000000000;1.06347656250000;1.06445312500000;1.06542968750000;1.06640625000000;1.06738281250000;1.06835937500000;1.06933593750000;1.07031250000000;1.07128906250000;1.07226562500000;1.07324218750000;1.07421875000000;1.07519531250000;1.07617187500000;1.07714843750000;1.07812500000000;1.07910156250000;1.08007812500000;1.08105468750000;1.08203125000000;1.08300781250000;1.08398437500000;1.08496093750000;1.08593750000000;1.08691406250000;1.08789062500000;1.08886718750000;1.08984375000000;1.09082031250000;1.09179687500000;1.09277343750000;1.09375000000000;1.09472656250000;1.09570312500000;1.09667968750000;1.09765625000000;1.09863281250000;1.09960937500000;1.10058593750000;1.10156250000000;1.10253906250000;1.10351562500000;1.10449218750000;1.10546875000000;1.10644531250000;1.10742187500000;1.10839843750000;1.10937500000000;1.11035156250000;1.11132812500000;1.11230468750000;1.11328125000000;1.11425781250000;1.11523437500000;1.11621093750000;1.11718750000000;1.11816406250000;1.11914062500000;1.12011718750000;1.12109375000000;1.12207031250000;1.12304687500000;1.12402343750000;1.12500000000000;1.12597656250000;1.12695312500000;1.12792968750000;1.12890625000000;1.12988281250000;1.13085937500000;1.13183593750000;1.13281250000000;1.13378906250000;1.13476562500000;1.13574218750000;1.13671875000000;1.13769531250000;1.13867187500000;1.13964843750000;1.14062500000000;1.14160156250000;1.14257812500000;1.14355468750000;1.14453125000000;1.14550781250000;1.14648437500000;1.14746093750000;1.14843750000000;1.14941406250000;1.15039062500000;1.15136718750000;1.15234375000000;1.15332031250000;1.15429687500000;1.15527343750000;1.15625000000000;1.15722656250000;1.15820312500000;1.15917968750000;1.16015625000000;1.16113281250000;1.16210937500000;1.16308593750000;1.16406250000000;1.16503906250000;1.16601562500000;1.16699218750000;1.16796875000000;1.16894531250000;1.16992187500000;1.17089843750000;1.17187500000000;1.17285156250000;1.17382812500000;1.17480468750000;1.17578125000000;1.17675781250000;1.17773437500000;1.17871093750000;1.17968750000000;1.18066406250000;1.18164062500000;1.18261718750000;1.18359375000000;1.18457031250000;1.18554687500000;1.18652343750000;1.18750000000000;1.18847656250000;1.18945312500000;1.19042968750000;1.19140625000000;1.19238281250000;1.19335937500000;1.19433593750000;1.19531250000000;1.19628906250000;1.19726562500000;1.19824218750000;1.19921875000000;1.20019531250000;1.20117187500000;1.20214843750000;1.20312500000000;1.20410156250000;1.20507812500000;1.20605468750000;1.20703125000000;1.20800781250000;1.20898437500000;1.20996093750000;1.21093750000000;1.21191406250000;1.21289062500000;1.21386718750000;1.21484375000000;1.21582031250000;1.21679687500000;1.21777343750000;1.21875000000000;1.21972656250000;1.22070312500000;1.22167968750000;1.22265625000000;1.22363281250000;1.22460937500000;1.22558593750000;1.22656250000000;1.22753906250000;1.22851562500000;1.22949218750000;1.23046875000000;1.23144531250000;1.23242187500000;1.23339843750000;1.23437500000000;1.23535156250000;1.23632812500000;1.23730468750000;1.23828125000000;1.23925781250000;1.24023437500000;1.24121093750000;1.24218750000000;1.24316406250000;1.24414062500000;1.24511718750000;1.24609375000000;1.24707031250000;1.24804687500000;1.24902343750000;1.25000000000000;1.25097656250000;1.25195312500000;1.25292968750000;1.25390625000000;1.25488281250000;1.25585937500000;1.25683593750000;1.25781250000000;1.25878906250000;1.25976562500000;1.26074218750000;1.26171875000000;1.26269531250000;1.26367187500000;1.26464843750000;1.26562500000000;1.26660156250000;1.26757812500000;1.26855468750000;1.26953125000000;1.27050781250000;1.27148437500000;1.27246093750000;1.27343750000000;1.27441406250000;1.27539062500000;1.27636718750000;1.27734375000000;1.27832031250000;1.27929687500000;1.28027343750000;1.28125000000000;1.28222656250000;1.28320312500000;1.28417968750000;1.28515625000000;1.28613281250000;1.28710937500000;1.28808593750000;1.28906250000000;1.29003906250000;1.29101562500000;1.29199218750000;1.29296875000000;1.29394531250000;1.29492187500000;1.29589843750000;1.29687500000000;1.29785156250000;1.29882812500000;1.29980468750000;1.30078125000000;1.30175781250000;1.30273437500000;1.30371093750000;1.30468750000000;1.30566406250000;1.30664062500000;1.30761718750000;1.30859375000000;1.30957031250000;1.31054687500000;1.31152343750000;1.31250000000000;1.31347656250000;1.31445312500000;1.31542968750000;1.31640625000000;1.31738281250000;1.31835937500000;1.31933593750000;1.32031250000000;1.32128906250000;1.32226562500000;1.32324218750000;1.32421875000000;1.32519531250000;1.32617187500000;1.32714843750000;1.32812500000000;1.32910156250000;1.33007812500000;1.33105468750000;1.33203125000000;1.33300781250000;1.33398437500000;1.33496093750000;1.33593750000000;1.33691406250000;1.33789062500000;1.33886718750000;1.33984375000000;1.34082031250000;1.34179687500000;1.34277343750000;1.34375000000000;1.34472656250000;1.34570312500000;1.34667968750000;1.34765625000000;1.34863281250000;1.34960937500000;1.35058593750000;1.35156250000000;1.35253906250000;1.35351562500000;1.35449218750000;1.35546875000000;1.35644531250000;1.35742187500000;1.35839843750000;1.35937500000000;1.36035156250000;1.36132812500000;1.36230468750000;1.36328125000000;1.36425781250000;1.36523437500000;1.36621093750000;1.36718750000000;1.36816406250000;1.36914062500000;1.37011718750000;1.37109375000000;1.37207031250000;1.37304687500000;1.37402343750000;1.37500000000000;1.37597656250000;1.37695312500000;1.37792968750000;1.37890625000000;1.37988281250000;1.38085937500000;1.38183593750000;1.38281250000000;1.38378906250000;1.38476562500000;1.38574218750000;1.38671875000000;1.38769531250000;1.38867187500000;1.38964843750000;1.39062500000000;1.39160156250000;1.39257812500000;1.39355468750000;1.39453125000000;1.39550781250000;1.39648437500000;1.39746093750000;1.39843750000000;1.39941406250000;1.40039062500000;1.40136718750000;1.40234375000000;1.40332031250000;1.40429687500000;1.40527343750000;1.40625000000000;1.40722656250000;1.40820312500000;1.40917968750000;1.41015625000000;1.41113281250000;1.41210937500000;1.41308593750000;1.41406250000000;1.41503906250000;1.41601562500000;1.41699218750000;1.41796875000000;1.41894531250000;1.41992187500000;1.42089843750000;1.42187500000000;1.42285156250000;1.42382812500000;1.42480468750000;1.42578125000000;1.42675781250000;1.42773437500000;1.42871093750000;1.42968750000000;1.43066406250000;1.43164062500000;1.43261718750000;1.43359375000000;1.43457031250000;1.43554687500000;1.43652343750000;1.43750000000000;1.43847656250000;1.43945312500000;1.44042968750000;1.44140625000000;1.44238281250000;1.44335937500000;1.44433593750000;1.44531250000000;1.44628906250000;1.44726562500000;1.44824218750000;1.44921875000000;1.45019531250000;1.45117187500000;1.45214843750000;1.45312500000000;1.45410156250000;1.45507812500000;1.45605468750000;1.45703125000000;1.45800781250000;1.45898437500000;1.45996093750000;1.46093750000000;1.46191406250000;1.46289062500000;1.46386718750000;1.46484375000000;1.46582031250000;1.46679687500000;1.46777343750000;1.46875000000000;1.46972656250000;1.47070312500000;1.47167968750000;1.47265625000000;1.47363281250000;1.47460937500000;1.47558593750000;1.47656250000000;1.47753906250000;1.47851562500000;1.47949218750000;1.48046875000000;1.48144531250000;1.48242187500000;1.48339843750000;1.48437500000000;1.48535156250000;1.48632812500000;1.48730468750000;1.48828125000000;1.48925781250000;1.49023437500000;1.49121093750000;1.49218750000000;1.49316406250000;1.49414062500000;1.49511718750000;1.49609375000000;1.49707031250000;1.49804687500000;1.49902343750000;1.50000000000000;1.50097656250000;1.50195312500000;1.50292968750000;1.50390625000000;1.50488281250000;1.50585937500000;1.50683593750000;1.50781250000000;1.50878906250000;1.50976562500000;1.51074218750000;1.51171875000000;1.51269531250000;1.51367187500000;1.51464843750000;1.51562500000000;1.51660156250000;1.51757812500000;1.51855468750000;1.51953125000000;1.52050781250000;1.52148437500000;1.52246093750000;1.52343750000000;1.52441406250000;1.52539062500000;1.52636718750000;1.52734375000000;1.52832031250000;1.52929687500000;1.53027343750000;1.53125000000000;1.53222656250000;1.53320312500000;1.53417968750000;1.53515625000000;1.53613281250000;1.53710937500000;1.53808593750000;1.53906250000000;1.54003906250000;1.54101562500000;1.54199218750000;1.54296875000000;1.54394531250000;1.54492187500000;1.54589843750000;1.54687500000000;1.54785156250000;1.54882812500000;1.54980468750000;1.55078125000000;1.55175781250000;1.55273437500000;1.55371093750000;1.55468750000000;1.55566406250000;1.55664062500000;1.55761718750000;1.55859375000000;1.55957031250000;1.56054687500000;1.56152343750000;1.56250000000000;1.56347656250000;1.56445312500000;1.56542968750000;1.56640625000000;1.56738281250000;1.56835937500000;1.56933593750000;1.57031250000000;1.57128906250000;1.57226562500000;1.57324218750000;1.57421875000000;1.57519531250000;1.57617187500000;1.57714843750000;1.57812500000000;1.57910156250000;1.58007812500000;1.58105468750000;1.58203125000000;1.58300781250000;1.58398437500000;1.58496093750000;1.58593750000000;1.58691406250000;1.58789062500000;1.58886718750000;1.58984375000000;1.59082031250000;1.59179687500000;1.59277343750000;1.59375000000000;1.59472656250000;1.59570312500000;1.59667968750000;1.59765625000000;1.59863281250000;1.59960937500000;1.60058593750000;1.60156250000000;1.60253906250000;1.60351562500000;1.60449218750000;1.60546875000000;1.60644531250000;1.60742187500000;1.60839843750000;1.60937500000000;1.61035156250000;1.61132812500000;1.61230468750000;1.61328125000000;1.61425781250000;1.61523437500000;1.61621093750000;1.61718750000000;1.61816406250000;1.61914062500000;1.62011718750000;1.62109375000000;1.62207031250000;1.62304687500000;1.62402343750000;1.62500000000000;1.62597656250000;1.62695312500000;1.62792968750000;1.62890625000000;1.62988281250000;1.63085937500000;1.63183593750000;1.63281250000000;1.63378906250000;1.63476562500000;1.63574218750000;1.63671875000000;1.63769531250000;1.63867187500000;1.63964843750000;1.64062500000000;1.64160156250000;1.64257812500000;1.64355468750000;1.64453125000000;1.64550781250000;1.64648437500000;1.64746093750000;1.64843750000000;1.64941406250000;1.65039062500000;1.65136718750000;1.65234375000000;1.65332031250000;1.65429687500000;1.65527343750000;1.65625000000000;1.65722656250000;1.65820312500000;1.65917968750000;1.66015625000000;1.66113281250000;1.66210937500000;1.66308593750000;1.66406250000000;1.66503906250000;1.66601562500000;1.66699218750000;1.66796875000000;1.66894531250000;1.66992187500000;1.67089843750000;1.67187500000000;1.67285156250000;1.67382812500000;1.67480468750000;1.67578125000000;1.67675781250000;1.67773437500000;1.67871093750000;1.67968750000000;1.68066406250000;1.68164062500000;1.68261718750000;1.68359375000000;1.68457031250000;1.68554687500000;1.68652343750000;1.68750000000000;1.68847656250000;1.68945312500000;1.69042968750000;1.69140625000000;1.69238281250000;1.69335937500000;1.69433593750000;1.69531250000000;1.69628906250000;1.69726562500000;1.69824218750000;1.69921875000000;1.70019531250000;1.70117187500000;1.70214843750000;1.70312500000000;1.70410156250000;1.70507812500000;1.70605468750000;1.70703125000000;1.70800781250000;1.70898437500000;1.70996093750000;1.71093750000000;1.71191406250000;1.71289062500000;1.71386718750000;1.71484375000000;1.71582031250000;1.71679687500000;1.71777343750000;1.71875000000000;1.71972656250000;1.72070312500000;1.72167968750000;1.72265625000000;1.72363281250000;1.72460937500000;1.72558593750000;1.72656250000000;1.72753906250000;1.72851562500000;1.72949218750000;1.73046875000000;1.73144531250000;1.73242187500000;1.73339843750000;1.73437500000000;1.73535156250000;1.73632812500000;1.73730468750000;1.73828125000000;1.73925781250000;1.74023437500000;1.74121093750000;1.74218750000000;1.74316406250000;1.74414062500000;1.74511718750000;1.74609375000000;1.74707031250000;1.74804687500000;1.74902343750000;1.75000000000000;1.75097656250000;1.75195312500000;1.75292968750000;1.75390625000000;1.75488281250000;1.75585937500000;1.75683593750000;1.75781250000000;1.75878906250000;1.75976562500000;1.76074218750000;1.76171875000000;1.76269531250000;1.76367187500000;1.76464843750000;1.76562500000000;1.76660156250000;1.76757812500000;1.76855468750000;1.76953125000000;1.77050781250000;1.77148437500000;1.77246093750000;1.77343750000000;1.77441406250000;1.77539062500000;1.77636718750000;1.77734375000000;1.77832031250000;1.77929687500000;1.78027343750000;1.78125000000000;1.78222656250000;1.78320312500000;1.78417968750000;1.78515625000000;1.78613281250000;1.78710937500000;1.78808593750000;1.78906250000000;1.79003906250000;1.79101562500000;1.79199218750000;1.79296875000000;1.79394531250000;1.79492187500000;1.79589843750000;1.79687500000000;1.79785156250000;1.79882812500000;1.79980468750000;1.80078125000000;1.80175781250000;1.80273437500000;1.80371093750000;1.80468750000000;1.80566406250000;1.80664062500000;1.80761718750000;1.80859375000000;1.80957031250000;1.81054687500000;1.81152343750000;1.81250000000000;1.81347656250000;1.81445312500000;1.81542968750000;1.81640625000000;1.81738281250000;1.81835937500000;1.81933593750000;1.82031250000000;1.82128906250000;1.82226562500000;1.82324218750000;1.82421875000000;1.82519531250000;1.82617187500000;1.82714843750000;1.82812500000000;1.82910156250000;1.83007812500000;1.83105468750000;1.83203125000000;1.83300781250000;1.83398437500000;1.83496093750000;1.83593750000000;1.83691406250000;1.83789062500000;1.83886718750000;1.83984375000000;1.84082031250000;1.84179687500000;1.84277343750000;1.84375000000000;1.84472656250000;1.84570312500000;1.84667968750000;1.84765625000000;1.84863281250000;1.84960937500000;1.85058593750000;1.85156250000000;1.85253906250000;1.85351562500000;1.85449218750000;1.85546875000000;1.85644531250000;1.85742187500000;1.85839843750000;1.85937500000000;1.86035156250000;1.86132812500000;1.86230468750000;1.86328125000000;1.86425781250000;1.86523437500000;1.86621093750000;1.86718750000000;1.86816406250000;1.86914062500000;1.87011718750000;1.87109375000000;1.87207031250000;1.87304687500000;1.87402343750000;1.87500000000000;1.87597656250000;1.87695312500000;1.87792968750000;1.87890625000000;1.87988281250000;1.88085937500000;1.88183593750000;1.88281250000000;1.88378906250000;1.88476562500000;1.88574218750000;1.88671875000000;1.88769531250000;1.88867187500000;1.88964843750000;1.89062500000000;1.89160156250000;1.89257812500000;1.89355468750000;1.89453125000000;1.89550781250000;1.89648437500000;1.89746093750000;1.89843750000000;1.89941406250000;1.90039062500000;1.90136718750000;1.90234375000000;1.90332031250000;1.90429687500000;1.90527343750000;1.90625000000000;1.90722656250000;1.90820312500000;1.90917968750000;1.91015625000000;1.91113281250000;1.91210937500000;1.91308593750000;1.91406250000000;1.91503906250000;1.91601562500000;1.91699218750000;1.91796875000000;1.91894531250000;1.91992187500000;1.92089843750000;1.92187500000000;1.92285156250000;1.92382812500000;1.92480468750000;1.92578125000000;1.92675781250000;1.92773437500000;1.92871093750000;1.92968750000000;1.93066406250000;1.93164062500000;1.93261718750000;1.93359375000000;1.93457031250000;1.93554687500000;1.93652343750000;1.93750000000000;1.93847656250000;1.93945312500000;1.94042968750000;1.94140625000000;1.94238281250000;1.94335937500000;1.94433593750000;1.94531250000000;1.94628906250000;1.94726562500000;1.94824218750000;1.94921875000000;1.95019531250000;1.95117187500000;1.95214843750000;1.95312500000000;1.95410156250000;1.95507812500000;1.95605468750000;1.95703125000000;1.95800781250000;1.95898437500000;1.95996093750000;1.96093750000000;1.96191406250000;1.96289062500000;1.96386718750000;1.96484375000000;1.96582031250000;1.96679687500000;1.96777343750000;1.96875000000000;1.96972656250000;1.97070312500000;1.97167968750000;1.97265625000000;1.97363281250000;1.97460937500000;1.97558593750000;1.97656250000000;1.97753906250000;1.97851562500000;1.97949218750000;1.98046875000000;1.98144531250000;1.98242187500000;1.98339843750000;1.98437500000000;1.98535156250000;1.98632812500000;1.98730468750000;1.98828125000000;1.98925781250000;1.99023437500000;1.99121093750000;1.99218750000000;1.99316406250000;1.99414062500000;1.99511718750000;1.99609375000000;1.99707031250000;1.99804687500000;1.99902343750000;2];
Vt=120;      %车速Vt(单位：km/h)
v=Vt/3.6;    %车速v(单位：m/s)             
fs=4;               %频域采样间隔
Ts=25;              %需模拟的时间序列总时间为Ts；
ld=0.5;lu=50;       %空间波长l的范围
fd=v/lu;fu=v/ld;    %设功率谱有效频率段上截止频率为fu(Xu)和下截止频率为fd(Xl) 
dt=0.0002;      %时间间隔dt;工程上多用下式确定时域采样间隔:dt=1/(2.5*fu)
%dt=1/(2.5*fu);
N=Ts/dt;            %时域和频域采样点数
Nr=2.^nextpow2(N);  %一般Nr不是正好为2的整数次幂,这时必须通过在数据末尾添0的办法以保证Nr为2的整数次幂;
df=1./(N*dt);      %频域采样间隔为df
Nf=(fu-fd)/df;      %在有效频段内的采样点数为Nf
%通过推导,得出只要满足fu<=1/2dt,便能满足N<=Nr/2(N0=fd/df;N=N0+Nf);

%% 美国六级标准谱
k=0.25;
av6=0.0339;wc6=0.8245;    %美国六级谱参数
w=2*pi*f;        %波长为0.5~50m
sv6=100*2*pi*k*av6*wc6^2./((w.^2).*(w.^2+wc6^2));

%% 计算时域序列的频谱模值 %三次样条插值得到Nf个点
f_test=f*v;
S_k=(1/2).*(1/v).*sv6;
S_k_yy=zeros(2*2049,1);
S_k_yy(2050:2*2049)=sv6;
for ii=1:2049
    S_k_yy(ii)=sv6(2049-ii+1);
end
S_k_xx=1:2015;
S_k_yy1=S_k(35:2049);
S_k_y=zeros(Nr/2,1);
Nd0=fd/df;Nd=round(Nd0);Nu0=fu/df;Nu=round(Nu0);
S_k_x=1:(Nu-Nd);
S_k_y(Nd+1:Nu)=interp1(S_k_xx,S_k_yy1,S_k_x,'spline');
S_k_y(1:Nd)=0;S_k_y(Nu+1:Nr/2)=0;
S_k_k=S_k_y;
Q=0+2*pi*rand(Nr/2,1);   %生成[0,2pi]均匀分布的随机数
xn=exp(Q.*i);
Xk=zeros(Nr,1);
Xk1=xn.*Nr/2.*((S_k_k.*df).^(0.5));
Xk(1:Nr/2)=Xk1;
Xk2=zeros(Nr/2,1);
for ii=1:Nr/2
    Xk2(ii)=real(Xk1(Nr/2-ii+1))-imag(Xk1(Nr/2-ii+1))*i;
end
Xk(Nr/2+1:Nr)=Xk2;
xk=ifft(Xk,Nr);

%% 取三个周期的时域样本
%Xkk=zeros(2*Nr,1);   
%for ii=1:Nr
 %   Xkk(Nr+ii)=Xk(ii);
%end
%Xkk(1:Nr)=Xk;
%xk=zeros(2*Nr,1);
%xk=ifft(Xkk,2*Nr);

%% 进行时间域功率谱计算
%周期图法参数
fs=4;
noverlap=1000;
nfft=2^nextpow2(6000);
xk_test=abs(xk);
%基于时间间隔为0.001s;故时间域频率为1000Hz
[psd_xk,ft]=pwelch(xk_test,hamming(4000),noverlap,nfft,(1/dt),'oneside');
%空间域与时间域的频率转换关系为wt=wu*f
zt=max(ft)/4097;
n1=0;t1=0;
n2=0;t2=0;
for jj=1:2049
    t1=t1+zt;
    n1=n1+1;
    if t1-fd>=0
        break;
    end
end
for jj=1:2049
    t2=t2+zt;
    n2=n2+1;
     if t2-fu>=0
        break;
     end
end  
sf=f*v;


%美国六级谱时间域谱函数如下：单位：mm^2/(1/s)
sv6=100*2*pi*k*av6*wc6^2./((w.^2).*(w.^2+wc6^2)).*(1/v)./2;
loglog(ft(n1:n2),psd_xk(n1:n2),':k','LineWidth',3);
hold on
loglog(sf(35:2049),sv6(35:2049), 'LineWidth',3);
xlabel('频率/Hz');
ylabel('PSD/mm^2/Hz');
legend('解析谱密度','拟合谱密度')
set(gca,'Fontname','Times New Roman','fontsize',16);
grid on;

%% 通过此程序发现拟合度与波长和采样时间间隔有关，
%如何寻找最优组合是需要进一步深入研究的问题





